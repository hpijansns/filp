<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FlipShop</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- HEADER -->

<div class="header">
<div class="header-logo" onclick="location.href='index.html'">
<img src="https://static-assets-web.flixcart.com/batman-returns/batman-returns/p/images/fkheaderlogo_exploreplus-44005d.svg" width="100">
</div>

<div class="header-actions">
<span onclick="location.href='cart.html'">ðŸ›’</span>
</div>
</div>


<!-- SEARCH -->

<div class="search-bar">
<input type="text" placeholder="Search for Products, Brands and More...">
</div>


<!-- CATEGORIES -->

<div class="categories-wrapper" id="categories"></div>


<!-- SLIDER -->

<div class="slider" id="slider"></div>


<!-- PRODUCTS -->

<div class="product-grid" id="productsGrid"></div>



<!-- FIREBASE SCRIPT -->
<script type="module" src="./script.js"></script>

<script>

function renderHome(){

let categories = getLS("categories",[])
let sliders = getLS("sliderImages",[])
let products = getLS("products",[])



/* CATEGORIES */

document.getElementById("categories").innerHTML =
categories.map(c=>`
<div class="category-item">
<img src="${c.img}" onerror="imgError(this)">
<span>${c.name}</span>
</div>
`).join("")



/* SLIDER */

document.getElementById("slider").innerHTML =
sliders.map((s,i)=>`
<img src="${s.url}" class="${i===0?'active':''}" onerror="imgError(this)">
`).join("")



/* PRODUCTS */

document.getElementById("productsGrid").innerHTML =
products.map(p=>{

let disc = calcDiscount(p.mrp,p.price)

return `
<div class="product-card">

<a href="product.html?id=${p.id}">
<img src="${p.mainImg}" onerror="imgError(this)">
<div class="product-title">${p.title}</div>

<div>
<span class="product-price">â‚¹${p.price}</span>

${disc>0 ? `
<span class="product-mrp">â‚¹${p.mrp}</span>
<span class="product-discount">${disc}% off</span>
`:""}

</div>
</a>

<button class="btn-add" onclick="addToCart('${p.id}')">
Add to Cart
</button>

</div>
`

}).join("")

}



/* FIRST LOAD */

renderHome()


/* FIREBASE UPDATE LISTENER */

document.addEventListener("dataUpdated", renderHome)



/* AUTO SLIDER */

setInterval(()=>{

let slides = document.querySelectorAll("#slider img")

if(slides.length < 2) return

let active = document.querySelector("#slider img.active")

let index = Array.from(slides).indexOf(active)

slides[index].classList.remove("active")

let next = (index+1) % slides.length

slides[next].classList.add("active")

},3000)

</script>

</body>
</html>
