<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<link rel="stylesheet" href="style.css">

<style>
body{background:#f5f5f5;padding-bottom:20px;}
.nav-tabs{display:flex;background:white;border-bottom:2px solid #ddd;overflow-x:auto}
.tab{padding:15px 20px;cursor:pointer;font-weight:bold;color:gray;white-space:nowrap}
.tab.active{color:#2874f0;border-bottom:3px solid #2874f0}
.tab-content{display:none}
.tab-content.active{display:block}
</style>
</head>
<body>

<div class="admin-header">Control Panel</div>

<div class="nav-tabs">
<div class="tab active" onclick="switchTab(this,'t-products')">Products</div>
<div class="tab" onclick="switchTab(this,'t-cats')">Categories</div>
<div class="tab" onclick="switchTab(this,'t-sliders')">Sliders</div>
<div class="tab" onclick="switchTab(this,'t-payments')">Payments</div>
<div class="tab" onclick="switchTab(this,'t-orders')">Orders</div>
</div>

<!-- PRODUCTS -->
<div id="t-products" class="tab-content active">

<div class="admin-section">
<h3>Add Product</h3>

<input id="pTitle" placeholder="Title"><br><br>
<input id="pPrice" placeholder="Price"><br><br>
<input id="pMrp" placeholder="MRP"><br><br>
<input id="pCat" placeholder="Category"><br><br>
<input id="pStock" placeholder="Stock"><br><br>
<input id="pImg" placeholder="Image URL"><br><br>

<button onclick="addProduct()">Save</button>
</div>

<div class="admin-section" id="admin-products-list"></div>

</div>


<!-- CATEGORY -->
<div id="t-cats" class="tab-content">

<div class="admin-section">

<input id="cName" placeholder="Category name">
<input id="cImg" placeholder="Image url">

<button onclick="addCategory()">Add</button>

</div>

<div id="admin-cat-list"></div>

</div>


<!-- SLIDER -->
<div id="t-sliders" class="tab-content">

<div class="admin-section">

<input id="sImg" placeholder="Slider image">

<button onclick="addSlider()">Add</button>

</div>

<div id="admin-slider-list"></div>

</div>


<!-- PAYMENTS -->
<div id="t-payments" class="tab-content">

<input id="payGpay" placeholder="Gpay link"><br><br>
<input id="payPhonepe" placeholder="PhonePe link"><br><br>
<input id="payPaytm" placeholder="Paytm link"><br><br>

<button onclick="savePayments()">Save</button>

</div>


<!-- ORDERS -->
<div id="t-orders" class="tab-content">

<div id="admin-order-list"></div>

</div>



<script type="module">

import { db, ref, push, set, update, remove, onValue }
from "./script.js";


window.switchTab = function(el,id){

document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'))
document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'))

el.classList.add('active')
document.getElementById(id).classList.add('active')

}


/* PRODUCT ADD */

window.addProduct = function(){

let title = document.getElementById("pTitle").value
let price = document.getElementById("pPrice").value

push(ref(db,"products"),{

title,
price,
mrp:document.getElementById("pMrp").value,
category:document.getElementById("pCat").value,
stock:document.getElementById("pStock").value,
mainImg:document.getElementById("pImg").value

})

alert("Product Added")

}


/* PRODUCT LIST */

onValue(ref(db,"products"), snap=>{

let html=""

snap.forEach(child=>{

let x = child.val()
let id = child.key

html+=`
<div style="display:flex;align-items:center;margin-bottom:10px">
<img src="${x.mainImg}" width="40">

<div style="flex:1;margin-left:10px">
<b>${x.title}</b><br>
₹${x.price}
</div>

<button onclick="deleteProduct('${id}')">Delete</button>

</div>
`

})

document.getElementById("admin-products-list").innerHTML=html

})


window.deleteProduct=function(id){

remove(ref(db,"products/"+id))

}



/* CATEGORY */

window.addCategory=function(){

push(ref(db,"categories"),{

name:document.getElementById("cName").value,
img:document.getElementById("cImg").value

})

}


onValue(ref(db,"categories"), snap=>{

let html=""

snap.forEach(child=>{

let x=child.val()
let id=child.key

html+=`
<div>
<img src="${x.img}" width="40">
${x.name}
<button onclick="deleteCategory('${id}')">Delete</button>
</div>
`

})

document.getElementById("admin-cat-list").innerHTML=html

})


window.deleteCategory=function(id){

remove(ref(db,"categories/"+id))

}



/* SLIDER */

window.addSlider=function(){

push(ref(db,"sliderImages"),{

url:document.getElementById("sImg").value

})

}


onValue(ref(db,"sliderImages"), snap=>{

let html=""

snap.forEach(child=>{

let x=child.val()
let id=child.key

html+=`
<div>
<img src="${x.url}" height="40">
<button onclick="deleteSlider('${id}')">Delete</button>
</div>
`

})

document.getElementById("admin-slider-list").innerHTML=html

})


window.deleteSlider=function(id){

remove(ref(db,"sliderImages/"+id))

}



/* PAYMENTS */

window.savePayments=function(){

set(ref(db,"paymentLinks"),{

gpay:document.getElementById("payGpay").value,
phonepe:document.getElementById("payPhonepe").value,
paytm:document.getElementById("payPaytm").value

})

alert("Saved")

}



/* ORDERS */

onValue(ref(db,"orders"), snap=>{

let html=""

snap.forEach(child=>{

let o=child.val()
let id=child.key

html+=`
<div style="border:1px solid #ddd;padding:10px;margin-bottom:10px">

<b>${o.address.name}</b><br>
${o.address.phone}<br>
₹${o.total}

<select onchange="updateStatus('${id}',this.value)">
<option ${o.status=="Pending"?"selected":""}>Pending</option>
<option ${o.status=="Shipped"?"selected":""}>Shipped</option>
<option ${o.status=="Delivered"?"selected":""}>Delivered</option>
</select>

</div>
`

})

document.getElementById("admin-order-list").innerHTML=html

})


window.updateStatus=function(id,status){

update(ref(db,"orders/"+id),{

status

})

}

</script>

</body>
</html>
